# 其他模型

前几章回顾了四个最广泛使用且通用的颜色外观模型，这些模型代表了朝向 CIECAM 模型演变的过程，这些模型和其他模型多年来不断被修改和引入。本章概述了另外三种颜色外观模型——其中一个模型已经发展多年，第二个模型是相对较新的，第三个模型有一个非常具体的目标，旨在预测恒定色相。由于本章所述的各种原因，这些模型不像前述的模型或更精细的 CIECAM 模型那样适合一般应用。然而，这些模型的某些方面在历史上和未来模型或应用的发展中都具有重要意义。因此，它们被纳入本章，以适当地涵盖它们对该领域的潜在影响。

---

## 14.1 概述


颜色外观模型的制定仍然是一个活跃的、持续进行的研究领域。这也解释了为什么本书只能提供相关问题的概述以及几种解决方法。无法提供一种“食谱式”的单一颜色外观模型来解决所有问题。这是该领域研究人员追求的“圣杯”，但短期内不太可能实现。第10章到第13章展示了历史上几种最有效的颜色外观模型，这些模型用于颜色外观规范和再现的问题的解决。第15章和第16章介绍了更近期的CIE颜色外观模型：CIECAM97s和CIECAM02。那些模型很可能是任何特定应用的最合适的解决方案。然而，一种模型不太可能成为所有应用的最佳解决方案。由于颜色外观模型的发展仍在持续进行，因此描述那些已经产生或可能对该领域产生重要影响的其他模型是很重要的。本章将介绍三个这样的模型：

1. 由Guth（1995）提出的ATD模型，该模型的开发历史超过20年（Guth 1994a）。
2. 由Luo等人（1996）提出的较新模型，称为LLAB。
3. 由Ebner和Fairchild（1998）提出的用于恒定色相预测的色彩空间，称为IPT。

第四个模型是由CIE技术委员会1-34开发的，旨在推动工业界颜色外观规范的一致性，当本书的第一版出版时，该模型正在开发中。该CIE颜色外观模型的当前状态在附录中进行了描述。在随后的几年里，这一模型——CIECAM97s，已经出版并广泛使用，并且经过了修订。在CIE TC8-01的进一步研究成果的基础上，CIECAM97s进行了改进，并被CIE在CIECAM02模型中采纳，后者在第16章中进行了讨论。

---

## 14.2 ATD模型

ATD模型，由Guth开发，是一种与前述（以及后续）章节描述的模型不同类型的模型。事实上，根据CIE TC1-34对颜色外观模型的定义，它不能被视为一个颜色外观模型。这是因为该模型是基于不同的目标开发的。它被描述为一个颜色视觉模型，或者更准确地说，是颜色视觉的前几个阶段。Guth（1994a，b）对该模型的发展和表现进行了很好的概述。该模型的历史可以追溯到1972年。ATD模型的开发旨在预测一系列广泛的视觉科学数据，涉及现象如色觉辨别、绝对阈值、贝佐尔-布鲁克色相偏移、阿布尼效应、异色亮度匹配、光适应和色度适应。ATD模型能够对这些现象的视觉数据做出显著的预测。然而，大多数此类实验使用的是不相关的刺激。因此，模型是为不相关的刺激设计的，只有通过某种程度上任意的修改，才能将其应用于相关颜色。这一背景解释了为什么该模型包含了色觉辨别、亮度、饱和度和色相的度量，但并没有区分其他重要的外观属性，如明度、色彩丰富度和色度。这使得模型的适用性受到了一定限制，但其一般结构和色度适应变换无疑值得进一步研究和关注。

ATD模型已经被修改并应用于实际的图像处理应用。Granger（1994, 1995）描述了这些应用。Granger（1994, 1995）利用ATD模型中的对立颜色编码，开发了一个用于描述颜色外观和在桌面出版中进行颜色操作的空间。然而，Granger（1994, 1995）并没有在他修改的ATD模型中加入任何色度适应变换；因此，该模型的实用性仅限于单一的照明白点，除非用户愿意做出错误的假设，即印刷色彩图像代表颜色恒定的刺激。

**目标与方法**  
如前所述，ATD模型有着长期的发展历史，旨在预测各种颜色视觉数据。Guth（1995）称其为“颜色感知和视觉适应的模型”，这无疑是一个恰当的描述。关于模型的用途，Guth（1995）表示，它“现在应该被视觉学界认真考虑作为所有目前用于预测（或建立标准）涉及人类颜色感知的模型的替代”。这是一个雄心勃勃的目标，显然与本书中其他一些模型的目标重叠。如下面所述，这也是对该模型能力的极度夸大。ATD模型的一个修订版，称为“ATD95”，将在以下部分中描述。Guth（1995）的处理方法已被采用。为获得更全面的理解，建议参考早期的论文，如Guth（1991），以了解模型的推导和能力。感兴趣的读者可以查阅关于模型修订的最新文献。

该模型从非线性视锥响应开始，接着是非线性的von Kries类型的受体增益控制和两个必要的对立响应阶段，以预测各种辨别和外观现象。最后，模型包括对立信号的神经压缩。字母A、T和D分别代表无色、三色盲和绿色盲机制。A系统信号表示亮度。

**输入数据**  
ATD模型在处理不相关颜色时的输入数据是X′Y′Z′三刺激值（Judd修改后的三刺激值，而不是CIE XYZ三刺激值），这些值以绝对亮度单位表示。X′Y′Z′三刺激值被缩放，使得Y′等于Y（光照亮度），并以托尔兰（trolands）为单位表示。托尔兰是一个视网膜照度的度量，考虑了眼睛的瞳孔直径。由于瞳孔直径在一定程度上受到场景亮度的控制，Guth（1995）建议通过将亮度提升到0.8的幂次并乘以18来合理地近似从cd/m²到托尔兰的转换。

严格来说，ATD模型与CIE色度学不兼容，因为它基于Judd修改后的X′Y′Z′三刺激值，而不是CIE XYZ三刺激值。然而，Guth（1995）指出，“在大多数情况下，使用XYZ值而非X′Y′Z′值可能是正确的。”对于本章的其余部分，假设使用CIE XYZ三刺激值。在涉及相关颜色的预测时，还必须提供适应刺激的绝对三刺激值X0Y0Z0。Guth（1995）对于如何获取这些值并不明确，因此假设它们是类似于测试刺激下的完美白色的三刺激值。ATD模型中不需要或使用其他任何输入数据。因此，显然它不能用于考虑背景、环境或认知效应。


**适应模型**

与本书中呈现的所有模型一样，ATD模型的第一步是将CIE（或Judd）三刺激值转换为视锥响应。然而，ATD模型的一个显著不同之处在于，视锥响应是非线性的，并且在此阶段引入了加性噪声信号。转换过程由方程14.1至14.3给出。

<div class="math-block">
  <div class="equation">
    $$
    L = 0.70 \cdot X + 0.66 \cdot Y + 0.2435 \cdot Z + 0.8524 \cdot Y - 0.0516 \cdot Z  \tag{14.1}
    $$
  </div>
</div>

<div class="math-block">
  <div class="equation">
    $$
    M = - 0.70 \cdot X + 1.0 \cdot Y + 0.3954 \cdot X + 1.1642 \cdot Y + 0.0837 \cdot Z + 0.036 \cdot X \tag{14.2}
    $$
  </div>
</div>

<div class="math-block">
  <div class="equation">
    $$
    S = 0.70 \cdot X + 0.43 \cdot Y + 0.04 \cdot Z + 0.6225 \cdot Y + 0.31 \cdot Z \tag{14.3}
    $$
  </div>
</div>

接下来，色度适应通过修改后的von Kries变换来建模，如方程14.4至14.6所示。

<div class="math-block">
  <div class="equation">
    $$
    L_g = L + \sigma_a \tag{14.4}
    $$
  </div>
</div>

<div class="math-block">
  <div class="equation">
    $$
    M_g = M + \sigma_a \tag{14.5}
    $$
  </div>
</div>

<div class="math-block">
  <div class="equation">
    $$
    S_g = S + \sigma_a \tag{14.6}
    $$
  </div>
</div>

其中，L_g、M_g和S_g是适应后的视锥信号。常数σ会根据不同的数据类型进行调整，但默认设为300。适应光的视锥信号La、Ma和Sa是通过刺激本身的三刺激值和完美白色（或其他适应刺激）的加权和来确定的，如方程14.7至14.9所示，随后通过方程14.1至14.3转换为视锥信号。

<div class="math-block">
  <div class="equation">
    $$
    L_a = k_1 X + k_2 X \tag{14.7}
    $$
  </div>
</div>

<div class="math-block">
  <div class="equation">
    $$
    M_a = k_1 Y + k_2 Y \tag{14.8}
    $$
  </div>
</div>

<div class="math-block">
  <div class="equation">
    $$
    S_a = k_1 Z + k_2 Z \tag{14.9}
    $$
  </div>
</div>

对于不相关颜色，仅有自适应，k1设为1.0，k2设为0.0。对于典型的色度计应用等相关颜色，k1设为0.0，k2设为15到50之间的值（Guth 1995）。在某些情况下，观察者可能对测试刺激和白点同时发生适应，并使用其他组合值，例如k1=1.0，k2=5.0（Guth 1995）。Guth（1995）并未明确推荐如何计算适应光的视锥信号，因此留给了使用者进行解释。然而，值得注意的是，随着k2值的增加，方程14.4至14.6的适应变换越来越像标准的von Kries变换。在色彩再现应用中，使ATD模型表现得与简单的von Kries模型几乎相同并不难。因此，建议在应用中将Guth的最大k2值设为50，并将k1设为0.0。

**对立颜色维度**

适应后的视锥信号随后转换为两组初始对立信号。第一阶段的初始信号记作A1i、T1i和D1i，并根据方程14.10至14.12计算。第二阶段的初始信号，根据方程14.13至14.15计算，记作A2i、T2i和D2i。

<div class="math-block">
  <div class="equation">
    $$
    A_{1i} = L_g + 3.57 \cdot M_g + 2.64 \tag{14.10}
    $$
  </div>
</div>

<div class="math-block">
  <div class="equation">
    $$
    T_{1i} = L_g + 7.18 \cdot M_g - 6.21 \tag{14.11}
    $$
  </div>
</div>

<div class="math-block">
  <div class="equation">
    $$
    D_{1i} = L_g + 0.70 \cdot M_g + 0.085 \cdot S_g + 1.00 \tag{14.12}
    $$
  </div>
</div>

<div class="math-block">
  <div class="equation">
    $$
    A_{2i} = A_{1i} + 0.09 \tag{14.13}
    $$
  </div>
</div>

<div class="math-block">
  <div class="equation">
    $$
    T_{2i} = T_{1i} + 0.43 \cdot T_{1i} + 0.76 \tag{14.14}
    $$
  </div>
</div>

<div class="math-block">
  <div class="equation">
    $$
    D_{2i} = D_{1i} \tag{14.15}
    $$
  </div>
</div>

最后，经过压缩后的ATD响应通过方程14.16至14.21计算，适用于第一阶段和第二阶段。

<div class="math-block">
  <div class="equation">
    $$
    A_{A1i} = A_{1i} + 200 \tag{14.16}
    $$
  </div>
</div>

<div class="math-block">
  <div class="equation">
    $$
    T_{T1i} = T_{1i} + 200 \tag{14.17}
    $$
  </div>
</div>

<div class="math-block">
  <div class="equation">
    $$
    D_{D1i} = D_{1i} + 200 \tag{14.18}
    $$
  </div>
</div>

<div class="math-block">
  <div class="equation">
    $$
    A_{A2i} = A_{2i} + 200 \tag{14.19}
    $$
  </div>
</div>

<div class="math-block">
  <div class="equation">
    $$
    T_{T2i} = T_{2i} + 200 \tag{14.20}
    $$
  </div>
</div>

<div class="math-block">
  <div class="equation">
    $$
    D_{D2i} = D_{2i} + 200 \tag{14.21}
    $$
  </div>
</div>

第一阶段的对立响应用于模拟明显的亮度和辨别（绝对和差异阈值）。辨别通过A1T1D1三维空间中的欧几里得距离进行建模，视觉阈值设定为大约0.005单位。第二阶段机制用于模拟较大的颜色差异、色相和饱和度。

---

**感知关联**

ATD模型包含预测亮度、饱和度和色相的度量。亮度关联是A1、T1和D1响应的二次和，如方程14.22所示。

<div class="math-block">
  <div class="equation">
    $$
    Br = \sqrt{A_1^2 + T_1^2 + D_1^2}  \tag{14.22}
    $$
  </div>
</div>

饱和度是第二阶段色度响应T2和D2的二次和，除以A2的无色响应，如方程14.23所示。

<div class="math-block">
  <div class="equation">
    $$
    CA = \sqrt{T_2^2 + D_2^2} / A_2 \tag{14.23}
    $$
  </div>
</div>

Guth（1995）错误地将饱和度和色度互换使用。然而，显然方程14.23的公式是饱和度的度量，而非色度，因为它是相对于刺激的无色响应来度量的，而不是相对于同样照明的白色的响应。Guth（1995）指出，色相与方程14.24中定义的H直接相关。然而，方程14.24中的比值是含糊的（对于互补色给出相同的值，对于某些色彩值为无穷大，对于其他色彩值则没有定义），因此有必要添加一个反正切函数，这也是典型的做法。

<div class="math-block">
  <div class="equation">
    $$
    H = \tan^{-1}\left( \frac{T_2}{D_2} \right)  \tag{14.24}
    $$
  </div>
</div>

ATD模型没有提供明度、色彩丰富度、色度或色相组成的关联。

**预测现象**

ATD模型考虑了色度适应、异色亮度匹配（Helmholtz-Kohlrausch效应）、贝佐尔-布鲁克色相偏移、阿布尼效应和各种色觉辨别实验。它包含了亮度和饱和度的关联。色相的关联也可以很容易地计算，尽管色相组成尚未被专门定义。该模型对于相关刺激定义不充分，因为它没有包括明度和色度的关联。无法区分亮度-色彩丰富度匹配和明度-色度匹配，使用ATD模型时可能预测的是亮度-色彩丰富度匹配，因为在ATD模型中使用了绝对单位。ATD模型不能（未经修改）用于预测背景或环境效应，或基于介质变化的效应，例如消光光源效应。使用ATD模型进行的计算值示例如 **表14.1** 所示。

---

**表14.1 示例 ATD 颜色视觉模型计算**

| 数量        | 案例1     | 案例2      | 案例3     | 案例4     |
|-------------|----------|-----------|----------|----------|
| X           | 19.01    | 57.06     | 3.53     | 19.01    |
| Y           | 20.00    | 43.06     | 6.56     | 20.00    |
| Z           | 21.78    | 31.96     | 2.14     | 21.78    |
| X₀          | 95.05    | 95.05     | 109.85   | 109.85   |
| Y₀          | 100.00   | 100.00    | 100.00   | 100.00   |
| Z₀          | 108.88   | 108.88    | 35.58    | 35.58    |
| Y₀ (cd/m²)  | 318.31   | 31.83     | 318.31   | 318.31   |
| σ           | 300      | 300       | 300      | 300      |
| k₁          | 0.0      | 0.0       | 0.0      | 0.0      |
| k₂          | 50.0     | 50.0      | 50.0     | 50.0     |
| A₁          | 0.1788   | 0.2031    | 0.0680   | 0.1068   |
| T₁          | 0.0287   | 0.0680    | -0.0110  | 0.0007   |
| D₁          | 0.0108   | 0.0005    | 0.0044   | 0.0130   |
| A₂          | 0.0192   | 0.0224    | 0.0106   | 0.0152   |
| T₂          | 0.0205   | 0.0308    | -0.0014  | 0.0102   |
| D₂          | 0.1814   | 0.2142    | 0.1075   | 0.1466   |
| B_r         | 1.206    | 1.371     | 0.436    | 1.091    |
| H           | 1.91     | 63.96     | -0.31    | 0.79     |

---

**为什不要仅使用ATD模型？**

ATD模型提供了一个简单而优雅的框架，适用于人类色觉系统中的信号处理早期阶段。虽然该框架在预测广泛的数据时表现出色，但对于特定应用并没有充分定义。模型的多个方面需要进一步定义或说明，才能用于实际应用。因此，ATD模型的灵活性使其能够预测广泛的数据，但也限制了它的实际用途。该模型可以通过一些修改应用于实际应用，正如Granger（1994, 1995）所做的那样。然而，即便如此，这一表述也不完整，因为它忽略了色度适应。

ATD模型的优点在于它相对简单，并且通常易于反转（对于k1=0.0）。缺点包括没有严格定义的实现方式、对相关颜色的处理不充分（这对大多数应用是必需的）以及缺少认知因素。严格来说，ATD模型也不能与CIE三刺激值直接关联。由于它没有为明度和色度提供独立的预测器，因此实际上不能被视为一个颜色外观模型。然而，作为视觉处理和辨别的框架，它无疑值得关注。

---

**ATD04模型**

应注意，Guth（1998）发布了一篇简短的论文，讨论了他认为在本书第一版中对ATD模型描述中的错误。感兴趣的读者可以查阅该出版物，并自行判断。自从本书的前两版出版以来，ATD模型经历了一些进一步的发展，最近的版本似乎是Guth（2004）在SPIE-IS&T电子成像会议的会议论文中发布的ATD04模型。该论文展示了模型细节的更新，但它仍然遵循本章中概述的基本结构。该论文还描述了为什么“颜色恒常性”是一个神话。以下是关于这个分析的详细阐述：

- 颜色恒常性（color constancy）是指视觉系统能够在光源变化的情况下保持颜色感知不变的现象。Guth的分析显示，颜色恒常性并不意味着精确的不变性，而是一个动态适应过程。在一些实际的颜色感知和色度适应研究中，研究人员很少会相信“颜色恒常性”是一种精确的、无误差的现象（参见第六章）。因此，Guth的观点在于，色度适应并非简单的恒常性，而是一种适应过程的体现。

- 然而，Guth对于传统颜色外观和颜色感知的观察科学有不同的见解。他继续否认定义相关和不相关颜色的需求，并对明度和亮度、色彩丰富度和色度之间的区分提出质疑。这些是视觉感知的基本属性。举例来说，如果没有这些区分，棕色和灰色这样的颜色名称就不会显得如此重要。

- Guth（2004）进一步指出，这些定义和区分在颜色视觉和色度适应的研究中是不可忽视的。他的立场与一些传统观点相矛盾，但他提出的论点对于推动视觉科学的深入思考和理解是有益的。对这些问题的反思，可以帮助研究人员更清晰地理解颜色感知的复杂性和它在不同情境下的表现。

如果您对相反的观点感兴趣，Guth（2004）提供了很多反思和分析，作为该领域的一个参考点，尤其是在“颜色恒常性”和颜色感知理论的探索中。

---

## 14.3 LLAB模型

LLAB模型是进入色彩外观模型领域的较新模型，其结构与第13章所述的RLAB模型类似。然而，LLAB模型确实包含了不同于RLAB模型的一些效应。LLAB色彩外观模型由Luo等人（1996）开发。然而，在Luo等人（1996）文章出版之前，LLAB模型在Luo和Morovic（1996）的会议论文中已被修订。本章中的描述遵循修订后的模型，并对Luo等人（1996）提出的原始公式进行了评论。

LLAB被设计为一个色度学模型，显然是CIE色度学的扩展（与视觉模型相对）。它是从一系列关于色彩外观和色差标定的实验结果中合成的。LLAB模型被设计为一个通用的色彩匹配、色彩外观规范和色差测量模型。因此，它融合了之前在这两个研究领域中的工作。与RLAB类似，LLAB旨在相对简单，且不包括所有视觉现象。它的简单程度不及RLAB模型，但它预测了一些RLAB不能预测的效应（反之亦然）。

**目标与方法**

LLAB模型，如Luo等人（1996）所述，是从Luo及其同事关于色彩外观标定和色彩辨别的大量数据中推导出的。这项工作已经对色彩外观模型进行了测试，并开发了色差方程，如Luo等人（1996）所总结。LLAB模型是将这些工作合成成一个单一一致的模型。类似的努力已经在CIECAM02色彩外观模型与色差结果的结合上进行，以创建被称为CAM02-UCS的模型（Luo等人，2006）。LLAB模型的公式与RLAB在概念上类似，但在细节上有显著不同。它从一个称为BFD变换的色度适应变换开始（此变换由Bradford开发，且未公开），从测试观看条件转换到定义的参考条件。然后，在参考条件下计算修正后的CIELAB坐标，并指定外观关联。背景的相对亮度通过与RLAB相似的可变指数进行考虑。色彩丰富度刻度基于CMC色差方程（Clarke等人，1984）中包含的非线性色度函数进行调整。LLAB还结合了由于背景相对亮度引起的明度对比因子。色相角度与CIELAB中的定义相同，色相组成按照与Nayatani等人、Hunt和RLAB相似的技术进行规定。最后，明度和色度的加权因子可用于以与CMC和CIE94色差方程相同的方式计算色差。因此，该模型的完整名称为LLAB(l:c)。

**输入数据**

LLAB模型需要刺激的相对三刺激值（XYZ）、参考白点的三刺激值（X0Y0Z0）、参考白点的亮度（以cd/m²为单位）、背景的亮度因子（Yb）。它还需要关于消光光源因子（D）、周围诱导因子（FS）、明度诱导因子（FL）和色度诱导因子（FC）的选择。指定观看条件的值见表14.2。

---

**LLAB 模型的输入数据**
**LLAB** 模型需要几个输入数据点：

- 刺激源的相对三刺激值（XYZ）。
- 参考白点（X₀Y₀Z₀）。
- 参考白点的亮度（L，单位：cd/m²）。
- 背景的亮度因子（Yb）。
- 与光源和环境条件相关的各种因素，详细内容见下文。

**表 14.2：LLAB 模型的诱导因子值**

| **条件** | **D** | **Fₛ** | **Fₗ** | **Fₓ** |
|----------|-------|--------|--------|--------|
| 反射样本和图像（视角大于4°） | 1.0 | 3.0 | 0.0 | 1.00 |
| 反射样本和图像（视角小于4°） | 1.0 | 3.0 | 1.0 | 1.00 |
| 电视和VDU显示器（昏暗环境） | 0.7 | 3.5 | 1.0 | 1.00 |
| 切片透明度（昏暗环境） | 1.0 | 5.0 | 1.0 | 1.10 |
| 35毫米投影透明度（暗环境） | 0.7 | 4.0 | 1.0 | 1.00 |

**色度适应变换**

在 **LLAB** 模型中，使用 **BFD** 适应变换，从 CIE XYZ 值计算参考观看条件下的对应颜色。色度适应处理步骤如下：

1. **视锥反应计算**：从 CIE XYZ 到标准化视锥反应，RGB 按照以下公式计算：

<div class="math-block">
  <div class="equation">
    $$
    \begin{pmatrix}
    R \\
    G \\
    B
    \end{pmatrix}
    = 
    \begin{pmatrix}
    X / Y \\
    Y / Y \\
    Z / Y
    \end{pmatrix}
    M \tag{14.25}
    $$
  </div>
</div>


<div class="math-block">
  <div class="equation">
    $$
    M = \begin{pmatrix}
    0.8951 & 0.2664 & -0.1614 \\
    -0.7502 & 1.7135 & 0.0367 \\
    0.0389 & -0.0685 & 1.0296
    \end{pmatrix} \tag{14.26}
    $$
  </div>
</div>


2. **转换为参考视锥反应**：然后，视锥反应根据参考光源进行调整，使用以下公式：


<div class="math-block">
  <div class="equation">
    $$
    R_r = \left[ D \left( \frac{R_{or}}{R_0} \right) + (1-D) \right] R \tag{14.27}
    $$
  </div>
</div>

<div class="math-block">
  <div class="equation">
    $$
    G_r = \left[ D \left( \frac{G_{or}}{G_0} \right) + (1-D) \right] G \tag{14.28}
    $$
  </div>
</div>

<div class="math-block">
  <div class="equation">
    $$
    B_r = \left[ D \left( \frac{B_{or}}{B_0^\beta} \right) + (1-D) \right] B^\beta \tag{14.29}
    $$
  </div>
</div>

<div class="math-block">
  <div class="equation">
    $$
    \beta = \left( \frac{B_0}{B_{or}} \right)^{0.0834} \tag{14.30}
    $$
  </div>
</div>

  
如果 B 反应值为负，使用方程 (14.31) 替换方程 (14.29)，以避免计算负数的平方根：

<div class="math-block">
  <div class="equation">
    $$
    B_r = - \left[ D \left( \frac{B_{or}}{B_0^\beta} \right) + (1-D) \right] |B|^\beta \tag{14.31}
    $$
  </div>
</div>



3. **最终视锥信号转换**：色度适应变换的最后一步是将参考观看条件下的视锥信号转换为 CIE 三刺激值：

<div class="math-block">
  <div class="equation">
    $$
    \begin{pmatrix}
    X_r \\
    Y_r \\
    Z_r
    \end{pmatrix}
    = M^{-1} 
    \begin{pmatrix}
    R_r Y \\
    G_r Y \\
    B_r Y
    \end{pmatrix} \tag{14.32}
    $$
  </div>
</div>


---
**对抗色维度**

在 **LLAB** 模型中，参考光源（D65）下的三刺激值通过修改后的 CIELAB 公式转化为初步的对抗维度。以下方程式展示了这种转化过程：

**初步对抗维度的方程：**

<div class="math-block">
  <div class="equation">
    $$
    L_L = 116 \cdot f \left( \frac{Y_r}{100} \right)^{2} - 16 \tag{14.33}
    $$
  </div>
</div>

<div class="math-block">
  <div class="equation">
    $$
    z = 1 + F_L \left( \frac{Y_b}{100} \right)^{1/2} \tag{14.34}
    $$
  </div>
</div>

<div class="math-block">
  <div class="equation">
    $$
    A = 500 \left[ f \left( \frac{X_r}{95.05} \right) - f \left( \frac{Y_r}{100} \right) \right] \tag{14.35}
    $$
  </div>
</div>

<div class="math-block">
  <div class="equation">
    $$
    B = 200 \left[ f \left( \frac{Y_r}{100} \right) - f \left( \frac{Z_r}{108.88} \right) \right] \tag{14.36}
    $$
  </div>
</div>


z指数被引入以考虑来自背景的光度对比度。它类似于Hunt模型中使用的形式。由于L*、A和B维度遵循CIELAB方程的定义，因此其非线性依赖于相对的三刺激值，正如方程14.37和14.38所示。对于$ \omega > 0.008856 $，使用方程14.37：

<div class="math-block">
  <div class="equation">
    $$
    f(\omega) = \left( \omega \right)^{1/F_s} \tag{14.37}
    $$
  </div>
</div>



---
**感知相关性**

LLAB模型包括光度、色度、色彩饱和度、饱和度、色相角和色相组成的预测因子。光度预测因子L*在方程14.33中定义。色度预测因子C*和色彩饱和度预测因子C1*是通过类似于CMC色差方程的非线性函数得出的，这些函数用作色度加权函数。这样就将CMC色差方程的行为引入到LLAB色空间中，如方程14.39至14.43所示。

**关键感知相关性的公式：**

- **色度，C**：  
<div class="math-block">
  <div class="equation">
    $$
    C = (A^2 + B^2)^{1/2} \tag{14.39}
    $$
  </div>
</div>

- **色彩饱和度，C1***：  
<div class="math-block">
  <div class="equation">
    $$
    C1* = 25 \ln(1 + 0.05C) \tag{14.40}
    $$
  </div>
</div>

- **色度组成，C1**：  
<div class="math-block">
  <div class="equation">
    $$
    C1 = C1* S_M S_C F_C \tag{14.41}
    $$
  </div>
</div>

- **饱和度，S_L**：  
<div class="math-block">
  <div class="equation">
    $$
    S_L = \frac{C1*}{L*} \tag{14.44}
    $$
  </div>
</div>

- **色相角（LLAB，h_L）**：  
<div class="math-block">
  <div class="equation">
    $$
    h_L = \tan^{-1} \left( \frac{B}{A} \right) \tag{14.45}
    $$
  </div>
</div>

这些方程用于建模人类在不同观察条件下如何感知颜色，包含了基于照明和周围环境变化的外观变化。


这一部分中，最终的对抗信号是使用色彩饱和度尺度C1*和色相角h_L计算的，如方程14.46和14.47所示。

- **对抗信号（A和B）**：  
<div class="math-block">
  <div class="equation">
    $$
    A_L = C_L \cos(h_L) \tag{14.46}
    $$
  </div>
</div>  
<div class="math-block">
  <div class="equation">
    $$
    B_L = C_L \sin(h_L) \tag{14.47}
    $$
  </div>
</div>

该部分指出，最初在LLAB模型中没有光度、色度或饱和度的预测因子。然而，Luo等人（1996）修订版本引入了色度和饱和度的预测因子。

---

**色差 (Color Differences)**

LLAB 模型结合了来自 CMC 色差公式的色度加权函数。色度依赖性是最重要的因素，它提升了 CMC 色差公式相较于简单的 CIELAB $\Delta E^*$ 公式的表现。因此，LLAB($l:c$) 色差定义如下：

<div class="math-block">
  <div class="equation">
    $$
    \Delta E_L = \left[ \left( \frac{\Delta L_L}{l} \right)^2 + \Delta A_L^2 + \Delta B_L^2 \right]^{0.5} \tag{14.48}
    $$
  </div>
</div>

明度加权 $l$ 被定义为 1.0、1.5 和 0.67，分别用于可感知度、可接受性和大色差。色度加权 $c$（在这个公式中未出现）始终被设为 1.0。

---

**预测的现象**

修订后的 LLAB 模型考虑了色度适应、明度诱导、周围相对亮度、照明剔除效应以及亨特效应。它无法预测史蒂文效应、不完全色度适应效应或赫尔姆霍尔茨–科尔劳施效应，也不能预测赫尔森–贾德效应。LLAB 包括了对明度、色度、饱和度、色彩感知度和色调的预测，这是其最新修订版的特点（Luo 和 Morivic，1996）。这一修订修正了原版本（Luo 等，1996）中外观属性（明度、色彩感知度、色调）组合的不自然性。正确的组合应为：明度、色度和色调，或亮度、色彩感知度和色调。原始的 LLAB 公式不能用于计算亮度–色彩感知度匹配或明度–色度匹配，只能用于预测明度–色彩感知度匹配，这在实际中几乎没有用处。如果在恒定亮度下预测对应颜色，则亮度–色彩感知度匹配变为等同于明度–色度匹配。值得注意的是，原始的 LLAB 公式并未满足 CIE TC1-34 色外观模型要求，即必须包括至少对明度、色度和色调的预测。这些局限性已在 Luo 和 Morivic（1996）提出的修订版中得到修正，本章进行了介绍。表 14.3 包含了 LLAB 色外观属性的示例计算。

---

**LLAB 色外观模型计算示例**

| Quantity | Case 1 | Case 2 | Case 3 | Case 4 |
| --- | --- | --- | --- | --- |
| X | 19.01 | 57.06 | 3.53 | 19.01 |
| Y | 20.00 | 43.06 | 6.56 | 20.00 |
| Z | 21.78 | 31.96 | 2.14 | 21.78 |
| X0 | 95.05 | 95.05 | 109.85 | 109.85 |
| Y0 | 100.00 | 100.00 | 100.00 | 100.00 |
| Z0 | 108.88 | 108.88 | 35.58 | 35.58 |
| L (cd/m²) | 318.31 | 31.83 | 318.31 | 31.83 |
| Yb | 20.0 | 20.0 | 20.0 | 20.0 |
| FS | 3.0 | 3.0 | 3.0 | 3.0 |
| FL | 1.0 | 1.0 | 1.0 | 1.0 |
| FC | 1.0 | 1.0 | 1.0 | 1.0 |
| LL | 37.37 | 61.26 | 16.25 | 39.82 |
| ChL | 0.01 | 30.51 | 30.43 | 29.34 |
| CL | 0.02 | 56.55 | 53.83 | 54.59 |
| sL | 0.00 | 0.50 | 1.87 | 0.74 |
| hL | 229.5 | 22.3 | 173.8 | 271.9 |
| HL | 72B | 28G | 98R | 2B |
| AL | −0.01 | 52.33 | −53.51 | 1.76 |
| BL | −0.01 | 21.43 | 5.83 | −54.5 |


**为什么不只使用 LLAB 模型？**

LLAB 模型的优点在于其相对简单，结合了潜在准确的适应模型，包含了周围效应，并且有可靠的内建色差测量。然而，其原始公式不能被视为一个完整的色外观模型，因为它预测了不常见的明度、色彩感知度和色调组合，但缺少对色度的预测。修订后的公式包括了色度和饱和度的预测。LLAB 的一个严重缺点是它不可逆。LLAB 还不能预测不完全色度适应。修订后的公式包括了可以用来建模在介质变化时出现的认知效应的 D 因子。最后，LLAB 还没有经过独立数据的测试（主要是因为 CIE 模型是在 LLAB 发布后不久制定的）。因此，模型中的一些参数可能过于拟合于某一组视觉数据，可能无法很好地推广到其他数据。然而，它在 Loughborough 大学的 LUTCHI 数据上的良好表现表明，它在某些应用中有相当大的潜力。

---

## 14.4 IPT 色彩空间 (IPT Color Space)

IPT 色彩空间由 Ebner 和 Fairchild（1998）发布，专门为图像处理应用而设计，具有简洁的公式，并且其色调角度组件能够较好地预测恒定感知色调（这一点在色域映射应用中尤为重要）。最近关于感知色调的研究验证了 IPT 空间在恒定色调预测方面的适用性。从 RGB 到 IPT 对立空间的转换比大多数色外观模型中使用的转换要简单。该过程通过公式 14.49 到 14.53 表达，涉及到线性变换到优化的锥体反应空间、应用幂函数非线性，并且最终通过线性变换得到 IPT 对立空间（I：明暗、P：红绿、T：黄蓝）。需要注意的是，输入的三刺激值是针对 CIE D65 光源的。因此，视场条件必须包含 D65 白点，或者首先应用选定的色度适应变换将其转换为 D65 适应下的相应色预测。

---

**各个字母的说明**

- **L**、**M**、**S**：这些是三个主轴的系数，分别对应视觉系统中的三种类型的锥体反应。L、M 和 S 代表长波、绿波和短波反应的系数，分别与红、绿、蓝的感知相对应。
  
- **L'**、**M'**、**S'**：这些是通过幂函数转换后得到的 L、M、S 的新值，用于后续的 IPT 空间的计算。公式中对于 L、M、S 值的正负符号也进行了处理，确保它们的转换符合视觉系统的实际反应。

- **I**：表示光明度（Light–dark），这是 IPT 空间中的第一个轴，表示明暗感知。
  
- **P**：表示红绿轴（Red–Green），用于表示红色与绿色的对比度。

- **T**：表示黄蓝轴（Yellow–Blue），用于表示黄色与蓝色的对比度。

- **hPT**：色调角度（Hue angle），通过 **T** 和 **P** 的比值计算得出，表示颜色的感知色调。其计算方式是利用反正切函数，计算 T 对 P 的比值。

---

<div class="math-block">
  <div class="equation">
    $$
    \begin{bmatrix}
    L & M & S
    \end{bmatrix} = \begin{bmatrix}
    0.4002 & 0.7075 & -0.0807 \\
    -0.2280 & 1.1500 & 0.0612 \\
    0.0 & 0.0 & 0.9184
    \end{bmatrix} 
    \begin{bmatrix}
    X_{D65} \\
    Y_{D65} \\
    Z_{D65}
    \end{bmatrix} 
    \tag{14.49}
    $$
  </div>
</div>

<div class="math-block">
  <div class="equation">
    $$
    L' = L^{0.43}, \quad L \geq 0
    $$ 
    $$
    L' = -|L|^{0.43}, \quad L \leq 0
    \tag{14.50}
    $$
  </div>
</div>

<div class="math-block">
  <div class="equation">
    $$
    M' = M^{0.43}, \quad M \geq 0
    $$ 
    $$
    M' = -|M|^{0.43}, \quad M \leq 0
    \tag{14.51}
    $$
  </div>
</div>

<div class="math-block">
  <div class="equation">
    $$
    S' = S^{0.43}, \quad S \geq 0
    $$ 
    $$
    S' = -|S|^{0.43}, \quad S \leq 0
    \tag{14.52}
    $$
  </div>
</div>

<div class="math-block">
  <div class="equation">
    $$
    \begin{bmatrix}
    I & P & T
    \end{bmatrix} = 
    \begin{bmatrix}
    0.4000 & 0.4000 & 0.2000 \\
    4.4550 & -4.8510 & 0.3960 \\
    0.8056 & 0.3572 & -1.1628
    \end{bmatrix}
    \begin{bmatrix}
    L' \\
    M' \\
    S'
    \end{bmatrix}
    \tag{14.53}
    $$
  </div>
</div>

<div class="math-block">
  <div class="equation">
    $$
    h_{PT} = \tan^{-1}\left( \frac{T}{P} \right)
    \tag{14.54}
    $$
  </div>
</div>

---

**为什么不只使用 IPT 模型？**

自从最初作为一个色彩空间，旨在优化恒定色调感知的预测以来，IPT 色彩空间已经在许多对色彩敏感的色域映射应用中得到了实施，如数字影院工作流和投影系统、电视制作工作流以及数字摄影系统。它还成为了图像基础色外观模型（Fairchild 和 Johnson，2002, 2003）、复杂视觉刺激的外观（Fairchild，2008b，2010）、高动态范围（HDR）图像和场景的色彩规格扩展（Fairchild 和 Chen，2011；Fairchild 和 Wyble，2010）以及无空间色外观尺度的开发（Fairchild，2011b；Fairchild 和 Heckaman，2012）的基础。尽管取得了这些成功，IPT 模型并不能解决所有问题。该模型没有包含色度适应的方法，因此在计算 IPT 坐标之前必须先应用适应变换。模型中也没有亮度、背景或周围环境的依赖性，因此不能解释这些效应。最后，模型的维度并非真正设计用于预测明度和色度，而是为了提供良好的对立表示。在这方面，还应注意，IPT 坐标在数学上并不正交。也就是说，对这三个维度进行空间滤波时，差异化的应用可能会导致意外的伪影。Johnson 等人（2010）讨论了大多数色彩空间的这种问题，他们还推导了一个正交对立色变换。

---

