
**图像外观建模的背景与发展**

自本书初版以来，色彩外观建模领域取得了显著进展。本书介绍的模型主要采取一种方法：尽可能将色彩与视觉表现的其他维度分离。然而，这些模型可能已经达到了其理论发展的极限，若想进一步取得突破，可能需要采用不同类型的模型。

Fairchild 和 Johnson（2002, 2003, 2004）提出了一种新的模型概念，被称为**图像外观模型**（Image Appearance Model）。这种模型将色彩外观模型扩展为包含空间和时间视觉特性的模型，能够预测复杂刺激中的外观表现，并用于测量图像差异（这是实现图像质量度量的第一步）。

本章将回顾图像外观建模的概念，并详细介绍其中一种模型，即 **iCAM**（图像颜色外观模型）。本章的大部分内容基于 Fairchild 和 Johnson (2004) 的综述文章。同时，章节的最后还会对色彩外观建模和图像外观建模领域的未来发展进行一些展望。

有关各类模型的最新进展以及在本书出版后出现的重要参考文献，请访问相关网站：  
[www.cis.rit.edu/fairchild/CAM.html](http://www.cis.rit.edu/fairchild/CAM.html)。  
关于 iCAM 模型的更新及相关源代码，请访问：[www.cis.rit.edu/mcsl/iCAM](http://www.cis.rit.edu/mcsl/iCAM)。

> 译者注：这个看起来令人费解，为何会出来一个图貌模型？这里是我的理解，通俗化来说就是：

> - 色貌模型关注单个颜色区域的感知，能够解释亮度、饱和度、色调之间的关系，但这些现象大多是在**简单的、均匀的**颜色区域中研究出来的。

> - 图貌模型扩展了色貌模型的能力，可以处理包含**多种颜色、细节和动态变化**的复杂场景，例如真实图像和视频。因此，图貌模型更适合用于视频播放、图像质量评价、HDR渲染等实际应用。
因此，图貌模型才是成像领域最应该关注的。

---
## 20.1 从色貌到图貌

图像测量的发展历史为图貌模型的提出与应用奠定了基础。图貌模型是一种自然演化，结合了色貌模型、空间视觉模型和时间视觉模型，将这些领域作为一个整体来看待，而非孤立的研究领域。

早期的成像系统要么未进行科学测量，要么采用专门测量成像系统变量的工具。例如，密度计最初用于测量摄影材料，以确定胶片中染料或银颗粒的含量。在印刷领域，类似的方法用于测量墨水以及半色调系统中的点覆盖面积。而在电子系统（如电视）中，系统信号电压则用于比色测量（Hunt 1995）。基于视觉的成像系统质量测量已有悠久历史，例如 Schade（1956）的开创性工作就是一个典型案例。然而，随着成像系统复杂性和开放性的提升，设备无关的图像测量需求变得愈加明显。

### Image Colorimetry

电子成像系统（尤其是彩色电视的发展）促进了设备无关图像色彩测量的首次应用。事实上，Wright（1981b）指出，若没有比色学的支撑，彩色电视根本无法发明。CIE系统在彩色电视系统（包括近代数字电视系统）的设计与标准化中取得了卓越成就。随着数字成像系统的普及，以及计算机生成和校对面向不同媒体的内容，CIE比色技术在成像系统中的应用愈加广泛。

CIE比色技术用于跨设备的图像色彩指定，有望解决开放式数字系统引发的新色彩再现问题。数字系统的灵活性使得对图像数据进行比色转换变得既可行又实际，从而在不同设备与媒体间实现色彩匹配。

关于成像设备校准与特性化的研究涵盖了从基础色彩测量技术到多种设备（包括CRT显示器、LCD显示器、投影设备、扫描仪、数字相机以及各种胶片记录与打印介质）的特性化。Berns（1997）总结了这一领域的一些核心概念与研究成果。这些能力是色貌与图貌研究与开发的基础。

设备特性化与校准的研究为解决设备无关色彩成像的核心问题提供了方法。例如，关于设备无关色彩成像设计与实现的概念研究（Fairchild 1994a）、色域映射算法（Braun 和 Fairchild 2000），该算法处理超出指定设备色域范围的目标色彩再现问题；以及用于计算机图形渲染的高质量光谱图像技术，这种技术显著提升了渲染场景中色彩准确性（Johnson 和 Fairchild 1999）。这类研究不仅建立在色貌模型的发展与测试基础上，还促进了跨媒体图像再现的研究进展。

### Color Difference Equations

**色差研究与 CIEDE2000 色差公式**

最近，色差研究的成果是**CIEDE2000 色差公式**的发布（Luo 等，2001）。在这些色差公式的核心部分，总是基于某种形式的**均匀色彩空间**（Uniform Color Space）。CIE 在 1976 年最初推荐了两种这样的色彩空间：**CIELAB** 和 **CIELUV**。这两个空间在最初都被描述为“临时色彩空间”，因为当时人们已经意识到它们还远未完善。

在一个真正均匀的色彩空间中，色差可以简单地通过两种颜色在该空间中的**距离**来衡量，例如通过 **CIE ∆E\*ab**（即 CIELAB 色差公式）。然而，由于 **CIELAB 色彩空间的非均匀性**，CIE 制定了更高级的色差公式，例如 **CIE DE94** 和 **CIEDE2000**，以更准确地预测感知到的色差。

这些更复杂的公式在预测**简单颜色块的感知色差**方面表现非常出色。然而，尽管存在这些限制，Stokes 等（1992）成功地证明了一点：一个简单的色差公式也能预测**整体颜色变化复杂的图像**中的色差阈值。他们的研究结果表明，对于复杂图像而言，**CIELAB 平均色差为 2.5 单位**是一个合理的感知阈值。

> 译者注：CIED2000色差公式罗明老师的代表作，也是华人在颜色科学领域里面最重要的贡献之一！

---

### Image Difference

CIE 色差公式是基于在受控观察条件下的简单色块开发的。因此，没有理由认为这些公式能够充分预测空间复杂的图像刺激的色差。**S-CIELAB 模型**（Zhang 和 Wandell，1996）被设计为标准 CIE 色差公式的**空间预处理器**，用以处理诸如半色调图案等复杂颜色刺激。空间预处理使用可分离卷积核来近似人类视觉系统的**空间对比敏感函数（CSF）**。CSF 的作用是去除视觉系统无法察觉的信息。例如，当在一定距离下观察半色调点时，这些点会模糊并融合成单一颜色。如果直接对连续图像与半色调图像进行逐像素的色差计算，将会产生非常大的误差，而实际感知到的差异可能非常小。空间预处理会对半色调图像进行模糊处理，使其更接近于连续色调图像。S-CIELAB 是基于 **CIELAB 色彩空间**与色差公式的第一个图像差异模型。

最近，该模型已被进一步优化，并扩展为一种用于图像色差计算的模块化框架（Johnson 和 Fairchild，2001a,b，2003a,b）。这一框架在**第 20.4 节**中进行了讨论，其改进了 S-CIELAB 模型中的 CSF 公式，并添加了**空间频率适应**、**空间定位**以及**局部与全局对比检测**模块。

### Color Appearance


遗憾的是，基本的 CIE 色度学并不能为图像规范提供完整的解决方案。由于数字系统生成或捕获的图像本质上会在截然不同的观察条件下被观看，例如：从最初捕获的场景，到昏暗房间中的计算机显示器，再到各种光源下的印刷媒介，甚至是在黑暗房间中的投影显示。因此，**色貌模型**被开发出来，以扩展 CIE 色度学，从而在不同媒体和观察条件下（而不仅仅是单一条件下）预测**色貌**（而不仅仅是颜色匹配）。

20 世纪 90 年代，应用于数字成像系统的**色貌建模研究**非常活跃，最终于 1997 年推荐了 **CIECAM97s 模型**（第 15 章），并在 2002 年推出其修订版本 **CIECAM02**（第 16 章）。这些模型的开发得益于为测试已发布的色貌模型在实际图像再现情况中的表现而进行的视觉实验（Braun 和 Fairchild，1997）。在成像应用中的色貌建模研究自然凸显了一些问题，这些问题在空间复杂图像的外观和图像质量问题上尚未得到充分解决。


### Image Appearance and Image Quality

颜色外观模型（CAMs）研究的是在不同观看条件下颜色的变化，主要包括光照的颜色（白点）、光照强度（亮度）以及周围环境的亮度对比。这些模型并不直接考虑人眼的视觉特性，比如空间和时间的变化，它们将每个图像像素（或者视频的每一帧）当作完全独立的刺激来处理。

视觉适应不仅在空间上发生变化，还在时间上有类似的过程。简单来说，视觉系统会根据周围环境的光线变化来调整感知，但这种调整不仅是针对空间的，时间上的变化也会影响感知效果。为了更准确地预测数字视频，特别是高动态范围（HDR）视频的外观，必须考虑到光线随时间变化的特性和色彩适应的过程。而在预测视频质量时，除了考虑图像的噪点或压缩伪影之外，还需要处理一些难以察觉的时间变化，比如视频中的“闪烁”现象，这种现象是因为画面在快速变化时，眼睛无法察觉到的细微波动。

**适应性的重要性**

适应性有明显的时间延迟特性。例如，当你突然打开黑暗房间里的灯时（比如早上醒来），你会发现亮度变化让你眼睛刺痛，因为光线太强，视觉系统一时无法适应这种过度的亮度。但过了一会儿，眼睛逐渐适应新的光照强度，视觉感知就恢复了正常。进入隧道也是类似的情况——从明亮的环境突然进入昏暗的隧道，眼睛会感觉不适，但也会逐渐适应。

Fairchild和Reniff（1995年）以及Rinner和Gegenfurtner（2000年）对色度适应过程的研究表明，时间适应也有类似的特性，眼球运动在空间适应中也起着重要作用，这些都可以应用到动态图像外观的预测模型中。

**视频质量与视频质量指标**

视频质量和视频质量度量的研究非常重要，尤其是在视频编码、压缩和解码算法（如MPEG2和MPEG4）的开发与优化方面。Daly（1993年）提出的静态图像质量预测模型（VDP）在预测JPEG图像压缩产生的伪影方面非常有效，可以用来估计图像中伪影的可见性。

与此不同，iCAM模型更多的是关注图像的质量尺度（例如清晰度、对比度、颗粒感等），它关注的是那些大于感知阈值的图像差异。这些差异是图像质量研究的一个重要部分，它们主要基于图像的外观。

在视频质量领域，也有类似的情况。虽然已有一些度量标准用于评估视频中的伪影是否可检测，但目前似乎还没有专门用于视频图像外观的模型，特别是用于渲染视频并预测视频中感知差异的模型。

**视频质量模型对比：Sarnoff JND模型与NASA DVQ模型**

**Sarnoff JND模型**

Sarnoff JND模型是JNDmetrix软件包的核心，基于Lubin（1993, 1995年）提出的多尺度空间视觉模型，并对色彩处理和时间变化进行了扩展。该模型旨在预测图像中伪影的可见性，换句话说，它关注的是那些能够被感知到的图像质量差异（通常称为“最小可察觉差异”）。然而，Sarnoff模型并没有考虑到色度和亮度的适应性，也没有处理时间特性的变化。

尽管如此，Sarnoff模型在检测视频中的快速时间变化（如闪烁）方面仍然有效，但它无法预测较慢的变化，因此不适用于视频的渲染。

**NASA DVQ模型**

NASA的数字视频质量（DVQ）模型与Sarnoff JND模型类似，但其实现方式有所不同。DVQ模型使用离散余弦变换（DCT）来分解图像，这使它非常适合硬件实现，并能够有效检测DCT视频压缩算法引入的伪影。与Sarnoff模型一样，DVQ模型关注的是伪影的可检测性，但它没有明确的外观处理机制，因此无法用于视频的渲染。

**图像外观模型的出现**

尽管颜色外观建模在设备无关的颜色成像方面取得了显著进展，并已经被广泛应用于现代的色彩管理系统，但在图像外观、空间视觉和图像质量方面，仍有许多可以改进的地方。为了弥补这些不足，近年来提出了图像外观模型（Fairchild 2002a,b, Fairchild 和 Johnson 2002），这些模型将颜色外观模型与空间视觉模型结合，以扩展颜色外观模型的能力。

传统的颜色外观模型（如CIECAM97s、CIECAM02）大多忽视了空间视觉特性，而图像质量中的空间视觉模型（如Daly 1993年、Lubin 1993年）则通常不考虑颜色因素。少数模型（如Retinex模型）则试图解决这些问题，并为图像外观建模奠定了基础。

图像外观模型的目标是将这些研究成果整合，创建一个通用的模型，既适用于图像外观的预测，也适用于图像的渲染与质量评估。例如，iCAM模型就是在这个框架下发展起来的，它结合了均匀色彩空间（Ebner和Fairchild 1998年）、图像周围环境的影响（Fairchild 1995b）、图像差异与质量测量算法（Fairchild 2002b，Johnson和Fairchild 2003a）的研究成果，并且考虑了观察者眼动的影响以及他们对自然场景的适应能力。

---

### Color and Image Appearance Models

能够预测复杂图像刺激之间的颜色差异的模型是一个非常有用的工具，但它也有一些局限性。就像颜色外观模型对于完全描述颜色刺激的外观是必要的，图像外观模型则是描述空间上复杂的颜色刺激所必需的。颜色外观模型能够描述诸如明度、亮度、色彩饱和度、色度和色相等属性。而图像外观模型在此基础上，进一步预测诸如清晰度、颗粒感、对比度和分辨率等属性。统一色彩空间也位于图像外观模型的核心部分。

模块化的图像差异框架在选择色彩空间时提供了极大的灵活性。常见的色彩空间包括CIELAB色彩空间，类似于S-CIELAB的色彩空间，CIECAM02颜色外观模型，以及IPT色彩空间（Ebner和Fairchild 1998年）。因此，模块化的图像差异框架可以在本章中描述的iCAM模型内实现，从而创建一个完整的图像外观和图像差异模型。如果需要，它也可以在其他色彩空间中实现。

图像外观模型可以用于制定多维度的图像质量模型。例如，可以将各种外观属性按权重求和，从而确定整体图像质量的度量，如Keelan（2002年）和Engledrum（2002年）所述。实际上，这些模型可以增强或替代人类观察，通过对图像属性进行加权，得出图像整体外观的质量。例如，一个质量模型可能包括色调平衡、对比度和清晰度的加权总和。以下部分将展示这类模型的初步步骤。


---
## 20.2 S-CIELAB


S-CIELAB模型是图像外观模型的一个优秀示例，就像CIELAB色彩空间提供了完整的颜色外观模型一样。S-CIELAB（Zhang和Wandell 1996年）为图像外观建模的概念提供了一个清晰的前身，并且仍然是图像差异计算中常用的技术。其实现已经被Johnson和Fairchild（2003b年）进一步澄清和扩展。

简单来说，S-CIELAB将CIELAB色彩空间和颜色差异方程结合，并通过空间滤波步骤有效地模糊掉无法感知的细节（例如半色调点），这些细节在颜色差异计算中应该被忽略。具体过程是：首先，将图像的XYZ三刺激值通过方程20.1和20.2中的变换转换为对立维度。然后，使用卷积核进行空间滤波，这些卷积核旨在表示亮度和色度的空间频率响应（CSF）。这些卷积核在方程20.3和20.4中有所定义。需要注意的是，这个滤波步骤依赖于图像的观看距离。接着，滤波后的图像被转换回XYZ，并进一步转换为CIELAB L*a*b*色彩空间，以便进行像素级的颜色差异计算。通过对这些图像差异图的统计汇总，可以尝试表示图像之间的差异。

<div class="math-block">
  <div class="equation">
    $$
    \begin{bmatrix} O_X \\ O_Y \\ O_Z \end{bmatrix} = M \begin{bmatrix} X \\ Y \\ Z \end{bmatrix}  \tag{20.1}
    $$
  </div>
</div>

<div class="math-block">
  <div class="equation">
    $$
    M = \begin{bmatrix} 0.279 & 0.72 & 0.107 \\ 0.449 & 0.29 & 0.077 \\ 0.086 & 0.59 & 0.501 \end{bmatrix} \tag{20.2}
    $$
  </div>
</div>

<div class="math-block">
  <div class="equation">
    $$
    E_i = \sum f_i k_i w_E  \tag{20.3}
    $$
  </div>
</div>

<div class="math-block">
  <div class="equation">
    $$
    f(x, y) = \sum \exp\left( -\frac{(x - x_i)^2 + (y - y_i)^2}{2\sigma^2} \right)  \tag{20.4}
    $$
  </div>
</div>

其中，缩放因子 \(k_i\) 选择使得 \(E_i\) 的总和为1.0，另一个缩放因子 \(k\) 选择使得每个色彩平面的 \(f\) 总和为1.0。

对于每个色度平面的参数 \( (w_i; s_i) \)，如下所示：  
- 亮度： \( (0.921, 0.105, -0.108; 0.0283, 0.133, 4.366) \)
- 红绿平面： \( (0.531, 0.330; 0.0392, 0.494) \)
- 蓝黄平面： \( (0.488, 0.371; 0.0536, 0.386) \)

---

## 20.3 iCAM Framework

